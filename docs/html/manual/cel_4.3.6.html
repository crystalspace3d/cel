<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Crystal Entity Layer: 4.3.6 Hover</title>

<meta name="description" content="Crystal Entity Layer: 4.3.6 Hover">
<meta name="keywords" content="Crystal Entity Layer: 4.3.6 Hover">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="PropClass-Hover"></a>
<a name="4.3.6"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="cel_4.3.5.html#4.3.5" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.4.html#4.4" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="cel_4.html#4." title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.3.html#4.3" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="cel_Index.html#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="cel_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="cel_Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="cel_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.3.6 Hover </h3>

<p>The mesh property class can be used to assign a 3D model to an entity.
This property class defines a visual representation for an entity.
This property class, defines a hovering object when used in conjunction
with <samp>`pcmechobject'</samp>.
</p>
<a name="SEC72"></a>
<h4 class="subsubheading"> Property Class Details </h4>

<ul>
<li> <em>Name</em>:
<samp>`pchover'</samp>
</li><li> <em>Factory ID</em>:
<samp>`cel.pcfactory.hover'</samp>
</li><li> <em>Interface</em>:
<code>iPcHover</code>
</li><li> <em>Header</em>:
<tt>`include/propclass/hover.h'</tt>
</li></ul>

<a name="SEC73"></a>
<h4 class="subsubheading"> General Information </h4>

<p>A Hovering object can be something like a hovercraft or a anti-gravity ship.
As well as hovering your object, it will also align it to the terrain, so
that as it goes down a hill, the ship will also tilt.
</p>
<p>This property class requires you to load it with an entity, which has a
<samp>`pcmesh'</samp> property class to act as the terrain it hovers over.
</p>
<a name="SEC74"></a>
<h4 class="subsubheading"> Setting the Terrain </h4>

<p>There are 2 ways to set the terrain mesh in <samp>`pchover'</samp>:
</p>
<ul>
<li>
Assuming you have the <code>iPcMesh</code> object, call <code>iPcHover-&gt;SetWorldMesh(pcmeshobj)</code>
</li><li>
Or you can use the entities name, as in <code>iPcHover-&gt;SetWorld(&quot;ent_level&quot;)</code>
</li></ul>

<p>This step is crucial, if you forget to do it the hovering system will not work.
</p>
<a name="SEC75"></a>
<h4 class="subsubheading"> Setting the Upthruster Function </h4>

<p>Instead of using the default upthruster function, you may want to provide your
own reactionary calculator.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">// CEL Includes
#include &quot;tools/stabiliser_dist.h&quot;

class CustomUpthrusterFunction : public celStabiliserFunction
{
public:
  float Force(celHoverObjectInfo obj_info)
  {
    /* when the height of the object
        is less then 2, use an
        upthrust force of 8 */
    if (obj_info.height &lt; 2)
      return 8.0;

    return 0.0;
  }
};
</pre></td></tr></table>
<p>Then to insert into the property class you would do
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">pchover-&gt;SetStabiliserFunction (new CustomUpthrusterFunction ());
</pre></td></tr></table>
<p>At runtime, everytime the objects iPcHover is updated, your upthruster function
will get called with information with the objects information on its state.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">struct celHoverObjectInfo
{
  /**
   * The height of the object above the
   * ground in along the world's y axis.
   */
  float height;

  /**
   * The vertical velocity of the object
   * along the objects local y axis.
   */
  float yvel;
};
</pre></td></tr></table>
<a name="SEC76"></a>
<h4 class="subsubheading"> angular correction </h4>

<p>This refers to the object correcting its angle as it flies over terrain (facing
downwards as it flies down hills).
</p>
<p>The implementation of this is done by calculating the object's height at its
center and then calculating the height away from the center.
Using the differences in height and a bit of trigonmetry, you can see the angle
of the object relative to the terrain.
</p>
<ul>
<li>
<code>iPcHover-&gt;SetAngularBeamOffset (float)</code> refers to how far away from the center of
the object the second height test is done.
Smaller values are better on more noisy terrain, but less accurate and more jerky,
whereas larger values are more likely to approximate (that small bump won't
get noticed).
Values like 0.5 are usually small enough to suffice.
</li><li>
<code>iPcHover-&gt;SetAngularCorrectionStrength (float)</code> is how fast the object corrects
its rotation. High values and it will jerk extremely fast, smaller and it will hardly
re-align.
1.0 is normal.
</li><li>
<code>iPcHover-&gt;SetAngularCutoffHeight (float)</code> is the height at which the angular
correction stops working - you obviously don't want a ship re-aligning itself with
terrain as its flying in the air.
</li></ul>



<hr size="1">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="cel_4.3.5.html#4.3.5" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.4.html#4.4" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="cel_4.html#4." title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.3.html#4.3" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="cel_Index.html#Index" title="Next chapter"> &gt;&gt; </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
