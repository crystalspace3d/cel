<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Crystal Entity Layer: 4.2.1 WalkTut Tutorial</title>

<meta name="description" content="Crystal Entity Layer: 4.2.1 WalkTut Tutorial">
<meta name="keywords" content="Crystal Entity Layer: 4.2.1 WalkTut Tutorial">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Tutorial-WalkTut"></a>
<a name="4.2.1"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="cel_4.2.html#4.2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.2.1.1.html#4.2.1.1" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="cel_4.html#4." title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.2.html#4.2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="cel_Index.html#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="cel_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="cel_Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="cel_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.2.1 WalkTut Tutorial </h3>

<p>This is a tutorial to show how you can use Crystal Entity Layer in your
own applications. The original game data and the Blender level and model
source used to create the artwork of this tutorial can be downloaded from:
</p>
<p><a href="http://www.crystalspace3d.org/celtutorial.zip">http://www.crystalspace3d.org/celtutorial.zip</a>
</p>
<p>The source files of this tutorial can be found in the
<tt>`apps/tutorial/walktut'</tt> directory that is included with <small>CEL</small>.
The world and entity file can be found in the <tt>`data'</tt> directory
(<tt>`walktut_world'</tt> and <tt>`walktut_entities'</tt>).
</p>
<p>Remember that the first time you run this application you have to
add the <samp>`-relight'</samp> commandline option so that the lightmaps are
correctly updated.
</p>
<p>During the game you can use the following inputs:
</p><ul>
<li>
<samp>`arrow keys'</samp>: movement.
</li><li>
<samp>`m'</samp>: camera mode (first person, third person, <small class="dots">...</small>).
</li><li>
<samp>`left mouse button'</samp>: pick up an item and put in inventory.
</li><li>
<samp>`d'</samp>: drop the last item picked up.
</li></ul>

<p>This tutorial features:
</p>
<ul>
<li>
Camera handling using the <samp>`pcdefaultcamera'</samp> property class.
</li><li>
Movement of an actor in a game using the <samp>`pclinearmovement'</samp> property
class.
</li><li>
Visualization of the player using the <samp>`pcmesh'</samp> property class.
</li><li>
Handling of the player inventory using the <samp>`pcinventory'</samp> property class.
</li><li>
Handling of keyboard and mouse input using the <samp>`pccommandinput'</samp>
property class.
</li><li>
Loading world and entity file using the <samp>`pczonemanager'</samp> property
class.
</li><li>
Usage of the <samp>`celentity'</samp> addon to add entities from an <small>XML</small> map
file.
</li><li>
How to create behaviours in C++ for game logic.
</li></ul>

<p>Here is the tutorial:
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="cel_4.2.1.1.html#4.2.1.1">4.2.1.1 main.cpp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="cel_4.2.1.2.html#4.2.1.2">4.2.1.2 app.h</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="cel_4.2.1.3.html#4.2.1.3">4.2.1.3 app.cpp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="cel_4.2.1.4.html#4.2.1.4">4.2.1.4 behave.h</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="cel_4.2.1.5.html#4.2.1.5">4.2.1.5 behave.cpp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>

<a name="SEC40"></a>
<h4 class="subsubheading"> The XML Entity File </h4>

<p>Except for the level and player entities all other entities are defined
in the <tt>`entities'</tt> file. Here is an example of how such an entity
looks:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">    &lt;addon plugin=&quot;celentity&quot; entityname=&quot;badone&quot;&gt;

      &lt;propclass name=&quot;pcmesh&quot;&gt;
        &lt;action name=&quot;LoadMeshPath&quot;&gt;
	  &lt;par name=&quot;path&quot; string=&quot;/this/model&quot; /&gt;
	  &lt;par name=&quot;filename&quot; string=&quot;monkey&quot; /&gt;
	  &lt;par name=&quot;factoryname&quot; string=&quot;monkey&quot; /&gt;
	&lt;/action&gt;
      &lt;/propclass&gt;

      &lt;propclass name=&quot;pcmeshselect&quot; /&gt;

      &lt;propclass name=&quot;pcproperties&quot;&gt;
        &lt;property name=&quot;pos1&quot; vector=&quot;9,2,8&quot; /&gt;
        &lt;property name=&quot;pos2&quot; vector=&quot;6,2,8&quot; /&gt;
        &lt;property name=&quot;pos3&quot; vector=&quot;6,2,12&quot; /&gt;
        &lt;property name=&quot;pos4&quot; vector=&quot;7,5,10&quot; /&gt;
        &lt;property name=&quot;pos5&quot; vector=&quot;8,1,7&quot; /&gt;
        &lt;property name=&quot;pos6&quot; vector=&quot;9,2,8&quot; /&gt;
        &lt;property name=&quot;up1&quot; vector=&quot;0,1,0&quot; /&gt;
        &lt;property name=&quot;up2&quot; vector=&quot;0,1,0&quot; /&gt;
        &lt;property name=&quot;up3&quot; vector=&quot;0,1,0&quot; /&gt;
        &lt;property name=&quot;up4&quot; vector=&quot;0,1,0&quot; /&gt;
        &lt;property name=&quot;up5&quot; vector=&quot;0,1,0&quot; /&gt;
        &lt;property name=&quot;up6&quot; vector=&quot;0,1,0&quot; /&gt;
        &lt;property name=&quot;forward1&quot; vector=&quot;-1,0,0&quot; /&gt;
        &lt;property name=&quot;forward2&quot; vector=&quot;0,0,1&quot; /&gt;
        &lt;property name=&quot;forward3&quot; vector=&quot;1,1,-1&quot; /&gt;
        &lt;property name=&quot;forward4&quot; vector=&quot;1,-1,-1&quot; /&gt;
        &lt;property name=&quot;forward5&quot; vector=&quot;1,1,1&quot; /&gt;
        &lt;property name=&quot;forward6&quot; vector=&quot;-1,0,0&quot; /&gt;
        &lt;property name=&quot;time1&quot; long=&quot;1000&quot; /&gt;
        &lt;property name=&quot;time2&quot; long=&quot;1000&quot; /&gt;
        &lt;property name=&quot;time3&quot; long=&quot;1000&quot; /&gt;
        &lt;property name=&quot;time4&quot; long=&quot;1000&quot; /&gt;
        &lt;property name=&quot;time5&quot; long=&quot;1000&quot; /&gt;
        &lt;property name=&quot;time6&quot; long=&quot;1000&quot; /&gt;
      &lt;/propclass&gt;

      &lt;propclass name=&quot;pctimer&quot;&gt;
        &lt;action name=&quot;WakeUp&quot;&gt;
	  &lt;par name=&quot;time&quot; long=&quot;5000&quot; /&gt;
	  &lt;par name=&quot;repeat&quot; bool=&quot;true&quot; /&gt;
	&lt;/action&gt;
      &lt;/propclass&gt;

      &lt;propclass name=&quot;pclinearmovement&quot;&gt;
        &lt;action name=&quot;InitCD&quot;&gt;
	  &lt;par name=&quot;body&quot; vector=&quot;.2,.2,.2&quot; /&gt;
	  &lt;par name=&quot;legs&quot; vector=&quot;.2,.2,.2&quot; /&gt;
	  &lt;par name=&quot;offset&quot; vector=&quot;0,-.3,0&quot; /&gt;
	&lt;/action&gt;
        &lt;action name=&quot;SetPosition&quot;&gt;
	  &lt;par name=&quot;position&quot; vector=&quot;9,3,8&quot; /&gt;
	  &lt;par name=&quot;sector&quot; string=&quot;Scene&quot; /&gt;
	  &lt;par name=&quot;yrot&quot; float=&quot;0&quot; /&gt;
	&lt;/action&gt;
      &lt;/propclass&gt;

      &lt;behaviour name=&quot;badone_behave&quot; /&gt;

    &lt;/addon&gt;
</pre></td></tr></table>
<p>In this particular example we use the <samp>`cel.addons.celentity'</samp> addon
(see section <a href="cel_4.4.1.html#4.4.1">CelEntity Addon</a>) to create an entity with the name <samp>`badone'</samp>.
It has the following property classes:
</p><ul>
<li> <samp>`pcmesh'</samp> (see section <a href="cel_4.3.5.html#4.3.5">Mesh</a>).
This mesh is setup with the <samp>`monkey'</samp> model that
was made in <samp>`Blender'</samp>.
</li><li> <samp>`pcmeshselect'</samp>
Used for selection of mesh.
</li><li> <samp>`pcproperties'</samp>
This is a generic property class for storing named properties. In this
particular case the <samp>`badone_behave'</samp> behaviour will read out the properties
to construct the path for the catmull rom spline.
</li><li> <samp>`pctimer'</samp> (see section <a href="cel_4.3.9.html#4.3.9">Timer</a>).
This timer will be used to restart the movement along the path after
5 seconds (5000 milliseconds).
</li><li> <samp>`pclinearmovement'</samp> (see section <a href="cel_4.3.4.html#4.3.4">Linear Movement</a>).
This is the generic movement system.
</li></ul>

<p>We also create the entity with the <samp>`badone_behave'</samp> behaviour.
</p>
<hr size="1">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="cel_4.2.html#4.2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.2.1.1.html#4.2.1.1" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="cel_4.html#4." title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="cel_4.2.html#4.2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="cel_Index.html#Index" title="Next chapter"> &gt;&gt; </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
