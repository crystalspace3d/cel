<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>celtool/stdparams.h Source File (CEL: Crystal Space Entity Layer Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
 <tr heigth="60">
  <td class="head" width="202" valign="top" style="padding-left:0;"><a href="http://cel.sf.net/"><img src="smalllogo.jpg" width="202" height="60" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
</table>
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>celtool/stdparams.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">    Crystal Space Entity Layer</span>
00003 <span class="comment">    Copyright (C) 2003 by Jorrit Tyberghein</span>
00004 <span class="comment">  </span>
00005 <span class="comment">    This library is free software; you can redistribute it and/or</span>
00006 <span class="comment">    modify it under the terms of the GNU Library General Public</span>
00007 <span class="comment">    License as published by the Free Software Foundation; either</span>
00008 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
00009 <span class="comment">  </span>
00010 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00013 <span class="comment">    Library General Public License for more details.</span>
00014 <span class="comment">  </span>
00015 <span class="comment">    You should have received a copy of the GNU Library General Public</span>
00016 <span class="comment">    License along with this library; if not, write to the Free</span>
00017 <span class="comment">    Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span>
00018 <span class="comment">*/</span>
00019 
00020 <span class="preprocessor">#ifndef __CEL_CELTOOL_PARAMS__</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#define __CEL_CELTOOL_PARAMS__</span>
00022 <span class="preprocessor"></span>
00023 <span class="preprocessor">#include "cstypes.h"</span>
00024 <span class="preprocessor">#include "csutil/scf.h"</span>
00025 <span class="preprocessor">#include "csutil/strhash.h"</span>
00026 <span class="preprocessor">#include "csutil/util.h"</span>
00027 <span class="preprocessor">#include "csutil/array.h"</span>
00028 <span class="preprocessor">#include "csutil/stringarray.h"</span>
00029 <span class="preprocessor">#include "behaviourlayer/behave.h"</span>
00030 
00031 <span class="comment">// The following macros will set 'var' to the required variable and</span>
00032 <span class="comment">// 'p_var' will be made to 0 if there is a failure.</span>
00033 <span class="preprocessor">#define CEL_FETCH_STRING_PAR(var,params,id) \</span>
00034 <span class="preprocessor">  const celData* p_##var = params-&gt;GetParameter (id); \</span>
00035 <span class="preprocessor">  const char* var = 0; \</span>
00036 <span class="preprocessor">  if (p_##var &amp;&amp; p_##var-&gt;type == CEL_DATA_STRING) { \</span>
00037 <span class="preprocessor">    var = p_##var-&gt;value.s-&gt;GetData (); \</span>
00038 <span class="preprocessor">  } else { p_##var = 0; }</span>
00039 <span class="preprocessor"></span><span class="preprocessor">#define CEL_FETCH_VECTOR3_PAR(var,params,id) \</span>
00040 <span class="preprocessor">  const celData* p_##var = params-&gt;GetParameter (id); \</span>
00041 <span class="preprocessor">  csVector3 var; \</span>
00042 <span class="preprocessor">  if (p_##var &amp;&amp; p_##var-&gt;type == CEL_DATA_VECTOR3) { \</span>
00043 <span class="preprocessor">    var.Set (p_##var-&gt;value.v.x, p_##var-&gt;value.v.y, p_##var-&gt;value.v.z); \</span>
00044 <span class="preprocessor">  } else { p_##var = 0; }</span>
00045 <span class="preprocessor"></span><span class="preprocessor">#define CEL_FETCH_FLOAT_PAR(var,params,id) \</span>
00046 <span class="preprocessor">  const celData* p_##var = params-&gt;GetParameter (id); \</span>
00047 <span class="preprocessor">  float var = 0.0f; \</span>
00048 <span class="preprocessor">  if (p_##var &amp;&amp; p_##var-&gt;type == CEL_DATA_FLOAT) { \</span>
00049 <span class="preprocessor">    var = p_##var-&gt;value.f; \</span>
00050 <span class="preprocessor">  } else { p_##var = 0; }</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define CEL_FETCH_LONG_PAR(var,params,id) \</span>
00052 <span class="preprocessor">  const celData* p_##var = params-&gt;GetParameter (id); \</span>
00053 <span class="preprocessor">  long var = 0; \</span>
00054 <span class="preprocessor">  if (p_##var &amp;&amp; p_##var-&gt;type == CEL_DATA_LONG) { \</span>
00055 <span class="preprocessor">    var = p_##var-&gt;value.l; \</span>
00056 <span class="preprocessor">  } else { p_##var = 0; }</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#define CEL_FETCH_BOOL_PAR(var,params,id) \</span>
00058 <span class="preprocessor">  const celData* p_##var = params-&gt;GetParameter (id); \</span>
00059 <span class="preprocessor">  bool var = false; \</span>
00060 <span class="preprocessor">  if (p_##var &amp;&amp; p_##var-&gt;type == CEL_DATA_BOOL) { \</span>
00061 <span class="preprocessor">    var = p_##var-&gt;value.bo; \</span>
00062 <span class="preprocessor">  } else { p_##var = 0; }</span>
00063 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="classcelGenericParameterBlock.html">00067</a> <span class="keyword">class </span><a class="code" href="classcelGenericParameterBlock.html">celGenericParameterBlock</a> : <span class="keyword">public</span> <a class="code" href="structiCelParameterBlock.html">iCelParameterBlock</a>
00068 {
00069 <span class="keyword">private</span>:
00070   size_t count;
00071   csStringID* ids;
00072   <a class="code" href="structcelData.html">celData</a>* data;
00073   <span class="keywordtype">char</span>** names;
00074 
00075 <span class="keyword">public</span>:
00076   <a class="code" href="classcelGenericParameterBlock.html">celGenericParameterBlock</a> (size_t count)
00077   {
00078     SCF_CONSTRUCT_IBASE (0);
00079     celGenericParameterBlock::count = count;
00080     ids = <span class="keyword">new</span> csStringID[count];
00081     data = <span class="keyword">new</span> <a class="code" href="structcelData.html">celData</a>[count];
00082     names = <span class="keyword">new</span> <span class="keywordtype">char</span>*[count];
00083     memset (names, 0, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>*)*count);
00084   }
00085   <span class="keyword">virtual</span> ~<a class="code" href="classcelGenericParameterBlock.html">celGenericParameterBlock</a> ()
00086   {
00087     <span class="keyword">delete</span>[] ids;
00088     <span class="keyword">delete</span>[] data;
00089     size_t i;
00090     <span class="keywordflow">for</span> (i = 0 ; i &lt; count ; i++)
00091       <span class="keyword">delete</span>[] names[i];
00092     <span class="keyword">delete</span>[] names;
00093   }
00094 
00095   <span class="keywordtype">void</span> SetParameterDef (size_t idx, csStringID id, <span class="keyword">const</span> <span class="keywordtype">char</span>* parname)
00096   {
00097     ids[idx] = id;
00098     <span class="keyword">delete</span>[] names[idx];
00099     names[idx] = csStrNew (parname);
00100   }
00101   <a class="code" href="structcelData.html">celData</a>&amp; <a class="code" href="classcelGenericParameterBlock.html#a5">GetParameter</a> (size_t idx) { <span class="keywordflow">return</span> data[idx]; }
00102 
00103   SCF_DECLARE_IBASE;
00104 
<a name="l00105"></a><a class="code" href="classcelGenericParameterBlock.html#a4">00105</a>   <span class="keyword">virtual</span> size_t <a class="code" href="classcelGenericParameterBlock.html#a4">GetParameterCount</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> count; }
<a name="l00106"></a><a class="code" href="classcelGenericParameterBlock.html#a5">00106</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classcelGenericParameterBlock.html#a5">GetParameter</a> (size_t idx, csStringID&amp; id,
00107         celDataType&amp; t)<span class="keyword"> const</span>
00108 <span class="keyword">  </span>{
00109     <span class="keywordflow">if</span> (<span class="comment">/*idx &lt; 0 || */</span>idx &gt;= count)
00110     {
00111       id = csInvalidStringID;
00112       t = CEL_DATA_NONE;
00113       <span class="keywordflow">return</span> 0;
00114     }
00115     id = ids[idx];
00116     t = data[idx].<a class="code" href="structcelData.html#o0">type</a>;
00117     <span class="keywordflow">return</span> names[idx];
00118   }
<a name="l00119"></a><a class="code" href="classcelGenericParameterBlock.html#a6">00119</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="structcelData.html">celData</a>* <a class="code" href="classcelGenericParameterBlock.html#a5">GetParameter</a> (csStringID id)<span class="keyword"> const</span>
00120 <span class="keyword">  </span>{
00121     size_t i;
00122     <span class="keywordflow">for</span> (i = 0 ; i &lt; count ; i++)
00123       <span class="keywordflow">if</span> (id == ids[i])
00124         <span class="keywordflow">return</span> &amp;data[i];
00125     <span class="keywordflow">return</span> 0;
00126   }
00127 };
00128 
<a name="l00132"></a><a class="code" href="classcelVariableParameterBlock.html">00132</a> <span class="keyword">class </span><a class="code" href="classcelVariableParameterBlock.html">celVariableParameterBlock</a> : <span class="keyword">public</span> <a class="code" href="structiCelParameterBlock.html">iCelParameterBlock</a>
00133 {
00134 <span class="keyword">private</span>:
00135   csArray&lt;csStringID&gt; ids;
00136   csArray&lt;celData&gt; data;
00137   csStringArray names;
00138 
00139 <span class="keyword">public</span>:
00140   <a class="code" href="classcelVariableParameterBlock.html">celVariableParameterBlock</a> ()
00141   {
00142     SCF_CONSTRUCT_IBASE (0);
00143   }
00144   <span class="keyword">virtual</span> ~<a class="code" href="classcelVariableParameterBlock.html">celVariableParameterBlock</a> ()
00145   {
00146   }
00147 
00148   <span class="keywordtype">void</span> SetParameterDef (size_t idx, csStringID id, <span class="keyword">const</span> <span class="keywordtype">char</span>* parname)
00149   {
00150     ids.GetExtend (idx) = id;
00151     <span class="keywordflow">if</span> (idx &gt;= names.Length ())
00152       names.SetLength (idx+1);
00153     names.Put (idx, parname);
00154   }
00155   <a class="code" href="structcelData.html">celData</a>&amp; <a class="code" href="classcelVariableParameterBlock.html#a5">GetParameter</a> (size_t idx) { <span class="keywordflow">return</span> data.GetExtend (idx); }
00156 
00157   SCF_DECLARE_IBASE;
00158 
<a name="l00159"></a><a class="code" href="classcelVariableParameterBlock.html#a4">00159</a>   <span class="keyword">virtual</span> size_t <a class="code" href="classcelVariableParameterBlock.html#a4">GetParameterCount</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> data.Length (); }
<a name="l00160"></a><a class="code" href="classcelVariableParameterBlock.html#a5">00160</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classcelVariableParameterBlock.html#a5">GetParameter</a> (size_t idx, csStringID&amp; id,
00161         celDataType&amp; t)<span class="keyword"> const</span>
00162 <span class="keyword">  </span>{
00163     <span class="keywordflow">if</span> (<span class="comment">/*idx &lt; 0 || */</span>idx &gt;= data.Length ())
00164     {
00165       id = csInvalidStringID;
00166       t = CEL_DATA_NONE;
00167       <span class="keywordflow">return</span> 0;
00168     }
00169     id = ids[idx];
00170     t = data[idx].type;
00171     <span class="keywordflow">return</span> names[idx];
00172   }
<a name="l00173"></a><a class="code" href="classcelVariableParameterBlock.html#a6">00173</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="structcelData.html">celData</a>* <a class="code" href="classcelVariableParameterBlock.html#a5">GetParameter</a> (csStringID id)<span class="keyword"> const</span>
00174 <span class="keyword">  </span>{
00175     size_t i;
00176     <span class="keywordflow">for</span> (i = 0 ; i &lt; data.Length () ; i++)
00177       <span class="keywordflow">if</span> (id == ids[i])
00178         <span class="keywordflow">return</span> &amp;data[i];
00179     <span class="keywordflow">return</span> 0;
00180   }
00181 };
00182 
<a name="l00186"></a><a class="code" href="classcelOneParameterBlock.html">00186</a> <span class="keyword">class </span><a class="code" href="classcelOneParameterBlock.html">celOneParameterBlock</a> : <span class="keyword">public</span> <a class="code" href="structiCelParameterBlock.html">iCelParameterBlock</a>
00187 {
00188 <span class="keyword">private</span>:
00189   csStringID id;
00190   <a class="code" href="structcelData.html">celData</a> data;
00191   <span class="keywordtype">char</span>* name;
00192 
00193 <span class="keyword">public</span>:
00194   <a class="code" href="classcelOneParameterBlock.html">celOneParameterBlock</a> ()
00195   {
00196     SCF_CONSTRUCT_IBASE (0);
00197     name = 0;
00198   }
00199   <span class="keyword">virtual</span> ~<a class="code" href="classcelOneParameterBlock.html">celOneParameterBlock</a> ()
00200   {
00201     <span class="keyword">delete</span>[] name;
00202   }
00203 
00204   <span class="keywordtype">void</span> SetParameterDef (csStringID id, <span class="keyword">const</span> <span class="keywordtype">char</span>* parname)
00205   {
00206     celOneParameterBlock::id = id;
00207     <span class="keyword">delete</span>[] name;
00208     name = csStrNew (parname);
00209   }
00210   <a class="code" href="structcelData.html">celData</a>&amp; <a class="code" href="classcelOneParameterBlock.html#a5">GetParameter</a> (<span class="keywordtype">int</span>) { <span class="keywordflow">return</span> data; }
00211 
00212   SCF_DECLARE_IBASE;
00213 
<a name="l00214"></a><a class="code" href="classcelOneParameterBlock.html#a4">00214</a>   <span class="keyword">virtual</span> size_t <a class="code" href="classcelOneParameterBlock.html#a4">GetParameterCount</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00215"></a><a class="code" href="classcelOneParameterBlock.html#a5">00215</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classcelOneParameterBlock.html#a5">GetParameter</a> (size_t idx, csStringID&amp; id,
00216         celDataType&amp; t)<span class="keyword"> const</span>
00217 <span class="keyword">  </span>{
00218     <span class="keywordflow">if</span> (idx != 0)
00219     {
00220       id = csInvalidStringID;
00221       t = CEL_DATA_NONE;
00222       <span class="keywordflow">return</span> 0;
00223     }
00224     id = celOneParameterBlock::id;
00225     t = data.<a class="code" href="structcelData.html#o0">type</a>;
00226     <span class="keywordflow">return</span> name;
00227   }
<a name="l00228"></a><a class="code" href="classcelOneParameterBlock.html#a6">00228</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="structcelData.html">celData</a>* <a class="code" href="classcelOneParameterBlock.html#a5">GetParameter</a> (csStringID id)<span class="keyword"> const</span>
00229 <span class="keyword">  </span>{
00230     <span class="keywordflow">if</span> (id != celOneParameterBlock::id) <span class="keywordflow">return</span> 0;
00231     <span class="keywordflow">return</span> &amp;data;
00232   }
00233 };
00234 
00235 <span class="preprocessor">#endif // __CEL_CELTOOL_PARAMS__</span>
00236 <span class="preprocessor"></span>
</pre></div><hr><address align="right"><small>Generated for CEL: Crystal Space Entity Layer by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.3 
</small></address> </body> </html>
